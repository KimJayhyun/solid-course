## 정의

```
**There should never be more than one reason for a class to change.**

Focused, single functionality addresses a specific concern.
```

단일 책임 원칙(Single Responsibility Principle, SRP)은 하나의 클래스가 하나의 책임만 가져야 한다는 원칙입니다.

**핵심 개념:**

- 클래스 변경 이유가 단 하나여야 함
- 각 클래스는 하나의 명확한 목적을 가짐
- 책임이 분리되면 코드 이해와 유지보수가 쉬워짐

**장점:**

- 변경 시 영향 범위가 제한적
- 테스트가 간단해짐
- 재사용성 향상
- 다른 개발자가 코드를 이해하기 쉬움

**판단 기준:**

"이 클래스가 변경되어야 하는 이유가 여러 개인가?"라고 질문했을 때, 답이 "예"라면 SRP를 위반한 것입니다.

## 리팩토링 이전

- [UserController.java](https://github.com/KimJayhyun/solid-course/blob/098fb4664c23df5a0199f0c7fedb8cae4d465d5d/src/main/java/com/company/singleresp/UserController.java)

```java
// UserController.java
public class UserController {
	//Store used by controller
    private Store store = new Store();

    //Create a new user
    public String createUser(String userJson) throws IOException {
        ObjectMapper mapper = new ObjectMapper();

        User user = mapper.readValue(userJson, User.class);

        if(!isValidUser(user)) {
            return "ERROR";
        }

        store.store(user);

        return "SUCCESS";
    }

    //Validates the user object
    private boolean isValidUser(User user) {
        ...
    }

    //Simply checks if value is null or empty..
    private boolean isPresent(String value) {
        ...
    }
    //check string for special characters
    private boolean isValidAlphaNumeric(String value) {
        ...
    }
    //check string for valid email address - this is not for prod.
    //Just for demo. This fails for lots of valid emails.
    private boolean isValidEmail(String value) {
        ...
    }

}
```

### 1. **UserController가 너무 많은 책임을 가짐**

- HTTP 요청 처리 (컨트롤러 역할)
- JSON 파싱/역직렬화
- 비즈니스 로직 (사용자 유효성 검증)
- 데이터 저장소 관리

### 2. **유효성 검증 로직이 컨트롤러에 포함됨**

- `isValidUser()`, `isPresent()`, `isValidAlphaNumeric()`, `isValidEmail()` 등의 검증 메서드들이 컨트롤러 내부에 있음
- 이 검증 로직들은 별도의 `UserValidator` 클래스로 분리되어야 함

### 3. **데이터 저장 책임**

- `Store` 인스턴스를 직접 생성하고 관리
- 저장소와의 통신은 별도의 `UserRepository` 또는 `UserService`가 담당해야 함

### 4. **변경의 이유가 여러 개**

이 클래스는 다음과 같은 이유로 변경될 수 있습니다:

- JSON 파싱 방식 변경
- 유효성 검증 규칙 변경
- 저장소 구현 변경
- HTTP 응답 형식 변경

## 리팩토링 이후

- [UserControoler.java](https://github.com/KimJayhyun/solid-course/blob/f730892fa1286fb7794ea14d90665012a10f5e01/src/main/java/com/company/singleresp/UserController.java)

```java
// UserController.java
public class UserController {

    private final  UserPersistenceService persistenceService = new UserPersistenceService();

    //Create a new user
    public String createUser(String userJson) throws IOException {
        ObjectMapper mapper = new ObjectMapper();

        User user = mapper.readValue(userJson, User.class);

        UserValidator validator = new UserValidator();
        boolean valid = validator.validateUser(user);

        if(!valid) {
            return "ERROR";
        }

        persistenceService.save(user);

        return "SUCCESS";
    }
}
```

- [UserPersistenceService.java](https://github.com/KimJayhyun/solid-course/blob/f730892fa1286fb7794ea14d90665012a10f5e01/src/main/java/com/company/singleresp/UserPersistenceService.java)

- [UserValidator.java](https://github.com/KimJayhyun/solid-course/blob/f730892fa1286fb7794ea14d90665012a10f5e01/src/main/java/com/company/singleresp/UserValidator.java)
