## 정의

1. **High level modules should not depend upon low level modules. Both should depend upon abstractions**

   - 상위 모듈은 하위 모듈에 의존해서는 안 된다. 둘 다 추상화에 의존해야 한다

2. **Abstractions should not depend upon details. Details should depend upon abstractions**

   - 추상화는 세부사항에 의존해서는 안 된다. 세부사항이 추상화에 의존해야 한다

## 핵심 개념

### 상위 모듈 vs 하위 모듈

- **상위 모듈**: 비즈니스 로직, 정책, 도메인에 특화된 모듈 (재사용성 낮음)
  - 예: `OrderService`, `UserService`, `PaymentProcessor`
- **하위 모듈**: 기술적 구현, 어디서든 사용 가능한 범용 모듈 (재사용성 높음)
  - 예: `MySQLDatabase`, `EmailSender`, `Logger`, `HttpClient`

### "역전(Inversion)"의 의미

전통적 방식에서는 상위 모듈이 하위 모듈의 구체적인 구현에 직접 의존했지만, DIP는 이 의존성의 방향을 역전시켜 **둘 다 추상화(인터페이스)에 의존**하도록 합니다.

## 코드 예시

### ❌ DIP 위반

```python
class MySQLDatabase:
    def save(self, data):
        print(f"MySQL에 저장: {data}")

class OrderService:  # 상위 모듈
    def __init__(self):
        self.db = MySQLDatabase()  # 하위 모듈에 직접 의존

    def save_order(self, order):
        self.db.save(order)
```

**문제점**: `OrderService`가 `MySQLDatabase`에 직접 의존하므로 데이터베이스를 변경하려면 상위 모듈을 수정해야 함

### ✅ DIP 준수

```python
from abc import ABC, abstractmethod

# 추상화
class Database(ABC):
    @abstractmethod
    def save(self, data):
        pass

# 하위 모듈 - 추상화에 의존
class MySQLDatabase(Database):
    def save(self, data):
        print(f"MySQL에 저장: {data}")

class PostgreSQLDatabase(Database):
    def save(self, data):
        print(f"PostgreSQL에 저장: {data}")

# 상위 모듈 - 추상화에 의존
class OrderService:
    def __init__(self, db: Database):
        self.db = db

    def save_order(self, order):
        self.db.save(order)
```

## 의존성 방향의 역전

```
전통적 방식:
[상위: OrderService]
        ↓ 의존
[하위: MySQLDatabase]

DIP 적용:
[상위: OrderService] → [추상화: Database]
                              ↑ 의존
                      [하위: MySQLDatabase]
```

하위 모듈이 상위 모듈(또는 추상화)을 따라가게 되므로 **의존성이 역전**됩니다.

## 장점

- **유연성**: 구현체를 쉽게 교체 가능
- **테스트 용이성**: Mock 객체로 대체하여 테스트 가능
- **재사용성**: 상위 모듈을 다양한 하위 모듈과 조합 가능
- **결합도 감소**: 모듈 간 의존성이 약해짐
- **확장성**: 새로운 구현체 추가가 기존 코드 수정 없이 가능

## 리팩토링 전

- [소스 코드](https://github.com/KimJayhyun/solid-course/tree/ea497c98298a63bb5006bdbabd4e850683a19c10/src/main/java/com/company/depinv)
